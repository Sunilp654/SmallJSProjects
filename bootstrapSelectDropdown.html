<html>

<head>
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-timepicker/0.5.2/css/bootstrap-timepicker.css"
        integrity="sha512-E4kKreeYBpruCG4YNe4A/jIj3ZoPdpWhWgj9qwrr19ui84pU5gvNafQZKyghqpFIHHE4ELK7L9bqAv7wfIXULQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer">
    <!-- <link href="/public/css/invoicestyle.css" rel="stylesheet"> -->
    <style>
       .SelectDropDown li a {
           display: block;
            cursor: pointer;
            padding: 2px 5px;
            color: #494949;
            text-decoration: none;
            border-radius: 3px;
       }

         .SelectDropDown li a:hover {
            color: #fff;
            background: #007bff;
         }
         .bootstrapSelect button::after{
            right: 10px;
            position: absolute;
            top: 50%;
            transform: translate(-50%);
         }
         .bootstrapSelect ul li a.active{
            color:#fff;
             background: #007bff;
         }
         .bootstrapSelect.multiSelect ul li a.selected{
            position: relative;
         }
         .bootstrapSelect.multiSelect ul li a.selected::after{
            content: "";
            display: inline-block;
            transform: rotate(45deg);
            height: 19px;
            width: 10px;
            border-bottom: 2px solid #333333;
            border-right: 2px solid #333333;
            position: absolute;
            right: 17px;
            top: 2px;
         }
         select.bootstrapSelect{
            display: none;
         }
         .bootstrapSelect.multiSelect .dropdown-toggle{
            width: 94% !important;
            border: 0;
            overflow: hidden;
         }
    </style>
</head>

<body>
    <div class="d-flex justify-content-between flex-column h-100">
        <div class="container">
            <div class="row m-0 mt-5">
                 <!-- <div class="col-md-5 mb-4">
                    <div class="form-group">
                       <select class="form-control bootstrapSelect" placeholder="option group drop down"  multiple>
                        <optgroup label="Default" taxes="">
                            <option value="0">New Tax</option>
                            <option value="0">New 2</option>
                        </optgroup>
                        <optgroup label="Custom" taxes="">
                            <option value="5611">test tax</option>
                            <option value="5691">Custom Tax</option>
                            <option value="12311">test tax 2</option>
                        </optgroup>
                       </select>
                    </div>
                </div> -->
                <div class="col-md-5 mb-4">
                    <div class="form-group">
                       <select class="form-control bootstrapSelect"  placeholder="Option First">
                        <option selected>option 1</option>
                        <option>option 2</option>
                        <option>option 3</option>
                        <option>option 4</option>
                        <option>option 5</option>
                       </select>
                    </div>
                </div>
                 <div class="col-md-5 mb-4">
                    <div class="form-group">
                       <select class="form-control bootstrapSelect" placeholder=""  multiple>
                        <option selected>option 2 1</option>
                        <option>option 2 2</option>
                        <option>option 2 3</option>
                        <option>option 2 4</option>
                       </select>
                    </div>
                </div>

                
                <div class="col-md-5">
                    <div class="form-group">
                       <select class="form-control bootstrapSelect" id="dropDownSelect" placeholder="option group drop down"  multiple>
                        <option selected>option 3 1</option>
                        <option>option 3 2</option>
                        <option selected>option 3 3</option>
                        <option>option 3 4</option>
                        <option>option 3 5</option>
                        <option>option 3 6</option>
                       </select>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script> -->

    <script>
         $.fn.dataget = function() {
            console.log("safsdfasd asdfas asdf");
         }
         //$('.newData').dataget();


        window.onload = function() {
            const dropdowns = document.querySelectorAll(".bootstrapSelect");
            dropdowns.forEach((dropdown, index) => {
                dropdown.style.display = 'none';
                dropdown.classList.add(`customDropDown${index}`);
                debugger
                    let IsmultipleSelect = (dropdown.getAttribute("multiple") == "" || dropdown.getAttribute("multiple") != null || dropdown.getAttribute("multiple") == "true" || dropdown.getAttribute("multiple") == true)
                    let inputValue = '';
                    let optionsList = ``;
                    let selectedItemArray  = [];
                    for(i=0; i < dropdown.options.length; i++){
                        if(IsmultipleSelect){
                            optionsList += `<li> <a href="javascript:void(0)" class="selectItem ${dropdown.options[i].attributes.selected !== undefined ? `selected` : `` }" onclick="multiSelect(this, ${index}, ${i})"> ${dropdown.options[i].value} </a> </li>`;
                            
                        }
                        else{
                            optionsList += `<li> <a href="javascript:void(0)" class="selectItem ${dropdown.options[i].attributes.selected !== undefined ? `active` : `` }" onclick="selectValue(this, ${index}, ${i})"> ${dropdown.options[i].value} </a> </li>`;
                            if(dropdown.options[i].attributes.selected){
                                inputValue = dropdown.options[i].text;
                            }
                        }
                    }
                    const htmlString = `<div id="dropDownId${index}" class="dropdown ${IsmultipleSelect ? `multiSelect` : ``} p-0 ${dropdown.classList.value}">
                    <input type="hidden" id="dropDownHiddenInput${index}" />
                    <button type="button" class="btn w-100 text-start dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" ${IsmultipleSelect ? `data-bs-auto-close="outside"` : ``}>
                    ${dropdown.attributes.placeholder == undefined  ? "Nothing Select" : (dropdown.attributes.placeholder.value ? dropdown.attributes.placeholder.value : "Nothing Select")}
                    </button>
                    <div class="dropdown-menu SelectDropDown w-100 p-2">
                    <input type="text" id="SearchInput${index}" onkeyup="SearchItem(${index})" class="form-control mb-2" placeholder="Search.." title="Type in a category">
                    <ul class="list-group" id="DropDownList${index}" style="list-style: none;">
                    ${optionsList}
                    </ul>
                    </div>
                    </div>`;
                    dropdown.insertAdjacentHTML('afterend', htmlString);
                    const parentDiv = document.getElementById(`dropDownId${index}`);
                    const childParagraph = parentDiv.querySelector('button');
                    //debugger
                    if(IsmultipleSelect){
                        //debugger
                        const allLinks = document.querySelectorAll(`ul#DropDownList${index} li a`);
                                allLinks.forEach((items)=>{
                                    //debugger
                                    if(items.classList.contains("selected")){
                                        selectedItemArray.push(items.text.trim());
                                    }
                                    inputValue =  selectedItemArray.join(", ");
                                })
                    }
                    if(inputValue)
                    {
                    childParagraph.innerHTML = inputValue.trim();
                    }
                    else
                    {
                    childParagraph.innerHTML = "Nothing Selected";
                    }

            })
    };

        function SearchItem(id) {
        var input, filter, ul, li, a, i;
        input = document.getElementById(`SearchInput${id}`);
        filter = input.value.toUpperCase();
        ul = document.getElementById(`DropDownList${id}`);
        li = ul.getElementsByTagName("li");
                for (i = 0; i < li.length; i++) {
                    a = li[i].getElementsByTagName("a")[0];
                    if (a.innerHTML.toUpperCase().indexOf(filter) > -1) {
                        li[i].style.display = "";
                    } else {
                        li[i].style.display = "none";
                    }
                }
            }


    function selectValue(event, dropdownId, optionId){
        debugger
        const SearchInput = document.getElementById(`SearchInput${dropdownId}`);
        SearchInput.value = "";
        SearchItem(dropdownId)
        // const anchorElement = listItem.querySelector('a');
        let listItem = document.getElementById(`DropDownList${dropdownId}`);
        let anchorElement = listItem.querySelectorAll('a');
        anchorElement.forEach((item)=>{
            item.classList.remove("active")
        })
        event.classList.add("active");
        const parentDiv = document.getElementById(`dropDownId${dropdownId}`);
        const childParagraph = parentDiv.querySelector('button');
        childParagraph.innerHTML = event.text.trim();
        const targetElement = document.getElementById(`dropDownId${dropdownId}`);
        const previousSibling = targetElement.previousElementSibling;
        if (previousSibling)
        {
            for(i=0; i<previousSibling.options.length; i++){
                previousSibling.options[i].removeAttribute("selected");
            }
            previousSibling.options[optionId].setAttribute('selected', "");
            
        } 
    }


    function multiSelect(event, dropdownId, optionId){
        const parentDiv = document.getElementById(`dropDownId${dropdownId}`);
        const childParagraph = parentDiv.querySelector('button');
        let inputValue = document.getElementById(`dropDownHiddenInput${dropdownId}`);
        let selectedItemArray  = [];
        let targetElement = document.getElementById(`dropDownId${dropdownId}`);
        let previousSibling = targetElement.previousElementSibling;
        if(event.classList.contains("selected"))
        {
            event.classList.remove("selected");
            const allLinks = document.querySelectorAll(`ul#DropDownList${dropdownId} li a`);
            allLinks.forEach((items)=>{
                if(items.classList.contains("selected")){
                    selectedItemArray.push(items.text.trim());
                }
                inputValue.value =  selectedItemArray.join(", ");
            })
            previousSibling.options[optionId].removeAttribute("selected");
        }
        else
        {
            event.classList.add("selected");
            const allLinks = document.querySelectorAll(`ul#DropDownList${dropdownId} li a`);
            allLinks.forEach((items)=>{
                if(items.classList.contains("selected")){
                    selectedItemArray.push(items.text.trim());
                }
                inputValue.value =  selectedItemArray.join(", ");
            })
            previousSibling.options[optionId].setAttribute("selected", "");
        }
         childParagraph.innerHTML = inputValue.value ? inputValue.value : "Nothing Select";
    }
    </script>



</body>
</html>